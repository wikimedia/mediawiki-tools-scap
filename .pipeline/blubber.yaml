# syntax = docker-registry.wikimedia.org/wikimedia/blubber-buildkit:0.9.0
#
# A Blubber spec file for a Docker container, based on Debian 9
# (stretch), where the Scap automated test suite can be run. This uses
# Debian packages to provide Scap dependencies, as those are what are
# used in production as well.
#
# Note that the package lists should match those in debian/control in
# the Scap source tree.

version: v4

runs:
  insecurely: True
  environment:
    LANG: C.UTF-8

apt:
  packages:
    - bash-completion
    - build-essential
    - ca-certificates
    - git
    - libjpeg-dev
    - openssl
    - php-cli
    - python3
    - python3-jinja2
    - python3-prettytable
    - python3-pygments
    - python3-requests
    - python3-yaml
    - zlib1g-dev
    - shellcheck
    - python3-pip

python:
  version: python3
  requirements:
    - test-requirements.txt
    - docs/requirements.txt
entrypoint: [scripts/check]

variants:
  stretch:
    copies: [local]
    base: docker-registry.wikimedia.org/wikimedia-stretch
  buster:
    copies: [local]
    base: docker-registry.wikimedia.org/wikimedia-buster
  bullseye:
    copies: [local]
    base: docker-registry.wikimedia.org/bullseye
